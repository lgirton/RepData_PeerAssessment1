---
title: "Reproducible Research: Peer Assessment 1"
author: "Lamont Girton"
output: 
  html_document:
    keep_md: true
---

```{r options}

options(digits = 2, scipen = 100)

```


## Loading and preprocessing the data

```{r fetch, results='hide'}

url <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"

if(!file.exists("data/activity.csv")) {
  dir.create("data/")
  download.file(url = url, destfile = "data/activity.zip", method = "curl")
  unzip("data/activity.zip", exdir = "data/")
  file.remove("data/activity.zip")
}

```


```{r load}

activity <- read.csv("data/activity.csv")
activity$date <- as.Date(activity$date)

```


## What is mean total number of steps taken per day?

```{r, warning=FALSE, message=FALSE}

library(dplyr)

activity_by_date <- activity %>% 
    group_by(date) %>% 
    summarise(steps=sum(steps))

```

```{r, fig.align='center'}

library(ggplot2)
ggplot(activity_by_date, aes(steps)) +
    geom_histogram(binwidth=1000, fill="salmon", color="black") +
    ggtitle("Histogram of Daily Step Totals") +
    labs(x = "Steps", y = "Count")

steps_mean <- mean(activity_by_date$steps, na.rm = T)
steps_medi <- median(activity_by_date$steps, na.rm = T)

```


The mean number of steps taken daily is **`r steps_mean`**.  The median number of steps is **`r steps_medi`**.


## What is the average daily activity pattern?

```{r, fig.align='center'}

activity_by_interval <- activity %>% 
    group_by(interval) %>% 
    summarise(mean_steps=mean(steps, na.rm = T))

ggplot(activity_by_interval, aes(interval, mean_steps)) +
    geom_line() +
    ggtitle("Average Number of Steps per Interval") +
    labs(x="Interval", y="Average Number of Steps")
```


```{r}

steps_max <- max(activity_by_interval$mean_steps)
interval_max <- activity_by_interval[activity_by_interval$mean_steps == steps_max, ]$interval

```

Interval `r interval_max` had the highest steps average across all intervals recorded (`r steps_max`).

## Imputing missing values

```{r}

num_missing <- nrow(activity[is.na(activity$steps) == TRUE,])

```

```{r}

activity_impute <- activity
activity_impute[is.na(activity_impute$steps), ]$steps <- mean(activity_impute$steps, na.rm = T)

activity_impute_by_date <- activity_impute %>% 
    group_by(date) %>% 
    summarise(steps=sum(steps))

ggplot(activity_impute_by_date, aes(steps)) +
    geom_histogram(binwidth=1000, fill="salmon", color="black") +
    ggtitle("Histogram of Daily Step Totals") +
    labs(x = "Steps", y = "Count")

```


## Are there differences in activity patterns between weekdays and weekends?

```{r, fig.align='center'}

activity_by_interval_day <- activity_impute %>%
    mutate(day_type=ifelse(weekdays(date, abbrev = T) %in% c("Sun", "Sat"), "Weekend", "Weekday")) %>% 
    group_by(day_type, interval) %>% 
    summarise(mean_steps=mean(steps, na.rm = T))

ggplot(activity_by_interval_day, aes(interval, mean_steps)) +
    geom_line() +
    facet_wrap(~day_type, ncol = 1)+
    ggtitle("Average Number of Steps per Interval") +
    labs(x="Interval", y="Average Number of Steps")

```


